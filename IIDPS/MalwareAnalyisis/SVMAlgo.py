import sys
import pandas as pd
from sklearn.pipeline import Pipeline
import numpy as np
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.metrics import classification_report, f1_score, accuracy_score, confusion_matrix
import pickle
from sklearn.svm import SVC
from sklearn.svm import LinearSVC

class SVMAlgo:

    def classification(train_file='malware_analysis_data.csv'):

        train_d = pd.read_csv(train_file)
        tfidf = TfidfVectorizer(stop_words='english',use_idf=True,smooth_idf=True)
        print("Start SVM Classification")
        nb_pipeline = Pipeline([('lrgTF_IDF', tfidf), ('lrg_mn', LinearSVC())])
        
        filename = 'svm_model.sav'
        pickle.dump(nb_pipeline.fit(train_d['Calls'], train_d['Malware']), open(filename, 'wb'))

        print("SVM Successfully Trained")


if __name__ == '__main__':
	SVMAlgo.classification()
